{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/start-project/src/components/Home.js\";\nimport React, { Component, useEffect } from 'react';\nimport { Button } from 'reactstrap';\nimport '../styles/profile-page.css';\nimport { authProvider } from '../authProvider';\nimport { getAllUsers, getUserEmail } from '../services/GraphService';\nexport class Home extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      usersList: []\n    };\n  }\n\n  componentDidMount() {\n    var user = authProvider.getAccount();\n\n    if (user) {\n      this.renderUsers();\n    }\n  }\n\n  async renderUsers() {\n    const accessToken = await authProvider.getAccessToken();\n    var users = getAllUsers(accessToken).then(response => response.json()).then(responseJSON => {\n      this.setState({\n        usersList: responseJSON.value\n      });\n      this.getEmailPerUser(\"AdeleV@rebardemo.onmicrosoft.com\");\n    });\n  }\n\n  async getEmailPerUser(userId) {\n    const accessToken = await authProvider.getAccessToken();\n    var emails = getUserEmail(userId, accessToken).then(response => response.json()).then(responseJSON => {\n      console.log(responseJSON);\n    }); //  return '<li>sasa</li>'\n  }\n\n  renderUserProfile(props) {\n    //console.log(this.state.usersList)\n    return React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-10\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"profile-head\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, \"Welcome Back, \", props.state.user.displayName), React.createElement(\"h6\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, props.state.user.jobTitle)), React.createElement(\"div\", {\n      style: {\n        marginTop: 20\n      },\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-10\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      style: {\n        listStyle: \"none\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }, this.state.usersList.map((user, index) => React.createElement(\"li\", {\n      key: index,\n      style: {\n        marginTop: 5,\n        marginBottom: 5\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        paddingLeft: 10,\n        border: '1px solid black'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, user.displayName, \" - \", user.jobTitle ? user.jobTitle : \"Me\", React.createElement(\"div\", {\n      style: {\n        fontSize: 10,\n        marginTop: 5,\n        marginBottom: 5\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, \"User Id: \", React.createElement(\"i\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, user.id)), React.createElement(\"p\", {\n      style: {\n        marginTop: -15\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, \"Email: \", user.mail), React.createElement(\"p\", {\n      style: {\n        marginTop: -15\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, \"Emails:\")), React.createElement(\"div\", {\n      style: {\n        fontSize: 9,\n        marginTop: -10,\n        marginBottom: 5\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      style: {\n        listStyle: \"none\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }))))))))), React.createElement(\"div\", {\n      className: \"col-md-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, React.createElement(Button, {\n      color: \"primary\",\n      onClick: props.authButtonMethod,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, \"Logout\")));\n  }\n\n  render() {\n    let contents = null;\n\n    if (this.props.isAuthenticated) {\n      contents = this.props.state.isLoading ? React.createElement(\"p\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, React.createElement(\"em\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, \"... Loading Your Profile ...\")) : this.renderUserProfile(this.props);\n    } else {\n      contents = React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"Rebar Extractor\"), React.createElement(Button, {\n        color: \"primary\",\n        onClick: this.props.authButtonMethod,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, \"Click here to sign in\"));\n    }\n\n    return React.createElement(\"div\", {\n      className: \"container user-profile\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, contents);\n  }\n\n}\nHome.displayName = Home.name;","map":{"version":3,"sources":["/Applications/MAMP/htdocs/start-project/src/components/Home.js"],"names":["React","Component","useEffect","Button","authProvider","getAllUsers","getUserEmail","Home","constructor","props","state","usersList","componentDidMount","user","getAccount","renderUsers","accessToken","getAccessToken","users","then","response","json","responseJSON","setState","value","getEmailPerUser","userId","emails","console","log","renderUserProfile","displayName","jobTitle","marginTop","listStyle","map","index","marginBottom","paddingLeft","border","fontSize","id","mail","authButtonMethod","render","contents","isAuthenticated","isLoading","name"],"mappings":"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","sourcesContent":["import React, { Component, useEffect } from 'react';\nimport {\n    Button\n} from 'reactstrap';\nimport '../styles/profile-page.css';\nimport { authProvider } from '../authProvider';\nimport { getAllUsers,getUserEmail} from '../services/GraphService';\nexport class Home extends Component {\n    static displayName = Home.name;\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            usersList: []\n        }\n    }\n\n    componentDidMount() {\n\n        var user = authProvider.getAccount();\n\n        if (user) {\n\n            this.renderUsers()\n\n        }\n       \n        \n        \n    }\n\n    async renderUsers () {\n        const accessToken = await authProvider.getAccessToken(); \n        var users = getAllUsers(accessToken)\n        .then((response) => response.json())\n        .then((responseJSON) => {\n            this.setState({usersList: responseJSON.value})\n            this.getEmailPerUser(\"AdeleV@rebardemo.onmicrosoft.com\")\n        });\n    }\n\n    async getEmailPerUser(userId) {\n        const accessToken = await authProvider.getAccessToken(); \n        var emails = getUserEmail(userId,accessToken)\n        .then((response) => response.json())\n        .then((responseJSON) => {\n           console.log(responseJSON)\n        });\n      //  return '<li>sasa</li>'\n    }\n\n     renderUserProfile(props) {\n        //console.log(this.state.usersList)\n        return (\n            <div className=\"row\">\n                <div className=\"col-md-10\">\n                    <div className=\"profile-head\">\n                        <h5>\n                           Welcome Back, {props.state.user.displayName}\n                        </h5>\n                        <h6>\n                            {props.state.user.jobTitle}\n                        </h6>\n                    </div>\n                    \n                    <div style={{marginTop:20}} className=\"row\">\n                        <div className=\"col-md-10\">\n                            <ul style={{listStyle:\"none\"}}>\n                                {this.state.usersList.map((user, index) => (\n                                    <li key={index} style={{marginTop:5,marginBottom: 5}}>\n                                        <div style={{paddingLeft:10,border:'1px solid black'}}>\n                                            {user.displayName} - {user.jobTitle ? user.jobTitle : \"Me\"}\n                                            <div style={{fontSize:10,marginTop:5,marginBottom: 5}}>\n                                                <p>User Id: <i>{user.id}</i></p>\n                                                <p style={{marginTop:-15}}>Email: {user.mail}</p>\n                                                <p style={{marginTop:-15}}>Emails:</p>\n                                            </div>\n                                            <div style={{fontSize:9,marginTop:-10,marginBottom: 5}}>\n                                                <ul style={{listStyle:\"none\"}}>\n                                                    {/* {this.getEmailPerUser(user.userPrincipalName)} */}\n                                                </ul>\n                                            </div>\n                                        </div>\n                                    </li>\n                                ))}\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"col-md-2\">\n                    <Button color=\"primary\" onClick={props.authButtonMethod}>Logout</Button>\n                </div>\n            </div>\n        );\n    }\n\n    render() {\n        let contents = null;\n\n        if (this.props.isAuthenticated) {\n            contents = this.props.state.isLoading\n                ? <p className=\"text-center\"><em>... Loading Your Profile ...</em></p>\n                : this.renderUserProfile(this.props);\n        }\n\n        else {\n            contents =\n                <div>\n                    <h2>Rebar Extractor</h2>\n                    <Button color=\"primary\" onClick={this.props.authButtonMethod}>Click here to sign in</Button>\n                </div>;\n        }\n\n        return (\n            <div className=\"container user-profile\">\n                {contents}\n            </div>\n        );\n    }\n}\n"]},"metadata":{},"sourceType":"module"}