{"ast":null,"code":"var graph = require('@microsoft/microsoft-graph-client');\n\nfunction getAuthenticatedClient(accessToken) {\n  // Initialize Graph client\n  const client = graph.Client.init({\n    // Use the provided access token to authenticate\n    // requests\n    authProvider: done => {\n      done(null, accessToken.accessToken);\n    }\n  });\n  return client;\n}\n\nexport async function getUserDetails(userId, accessToken) {\n  const client = getAuthenticatedClient(accessToken);\n  const user = await client.api('/' + userId).get();\n  return user;\n}\nexport async function getUserPhoto(userId, accessToken) {\n  var url = 'https://graph.microsoft.com/v1.0/' + userId + '/photo/$value';\n  return fetch(url, {\n    method: 'GET',\n    headers: {\n      Authorization: 'Bearer ' + accessToken.accessToken,\n      'Content-Type': 'application/json'\n    }\n  });\n}\nexport async function getUserEmail(userId, accessToken) {\n  const client = graph.Client.init({\n    authProvider: done => {\n      done(null, accessToken.accessToken);\n    }\n  });\n  let res = await client.api('/users/25d251d7-f5c3-4f60-b9aa-72f079d32ba1/messages').select('sender,subject').get();\n}\nexport async function getAllUsers(accessToken) {\n  var url = 'https://graph.microsoft.com/v1.0/users';\n  return fetch(url, {\n    method: 'GET',\n    headers: {\n      Authorization: 'Bearer ' + accessToken.accessToken,\n      'Content-Type': 'application/json'\n    }\n  });\n}","map":{"version":3,"sources":["/Applications/MAMP/htdocs/start-project/src/services/GraphService.js"],"names":["graph","require","getAuthenticatedClient","accessToken","client","Client","init","authProvider","done","getUserDetails","userId","user","api","get","getUserPhoto","url","fetch","method","headers","Authorization","getUserEmail","res","select","getAllUsers"],"mappings":"AAAA,IAAIA,KAAK,GAAGC,OAAO,CAAC,mCAAD,CAAnB;;AAEA,SAASC,sBAAT,CAAgCC,WAAhC,EAA6C;AACzC;AACA,QAAMC,MAAM,GAAGJ,KAAK,CAACK,MAAN,CAAaC,IAAb,CAAkB;AAC7B;AACA;AACAC,IAAAA,YAAY,EAAGC,IAAD,IAAU;AACpBA,MAAAA,IAAI,CAAC,IAAD,EAAOL,WAAW,CAACA,WAAnB,CAAJ;AACH;AAL4B,GAAlB,CAAf;AAQA,SAAOC,MAAP;AACH;;AAED,OAAO,eAAeK,cAAf,CAA8BC,MAA9B,EAAsCP,WAAtC,EAAmD;AAEtD,QAAMC,MAAM,GAAGF,sBAAsB,CAACC,WAAD,CAArC;AAEA,QAAMQ,IAAI,GAAG,MAAMP,MAAM,CAACQ,GAAP,CAAW,MAAMF,MAAjB,EAAyBG,GAAzB,EAAnB;AAEA,SAAOF,IAAP;AACH;AAED,OAAO,eAAeG,YAAf,CAA4BJ,MAA5B,EAAoCP,WAApC,EAAiD;AAEpD,MAAIY,GAAG,GAAG,sCAAsCL,MAAtC,GAA+C,eAAzD;AAEA,SAAOM,KAAK,CAACD,GAAD,EAAM;AACdE,IAAAA,MAAM,EAAE,KADM;AAEdC,IAAAA,OAAO,EAAE;AACLC,MAAAA,aAAa,EAAE,YAAYhB,WAAW,CAACA,WADlC;AAEL,sBAAgB;AAFX;AAFK,GAAN,CAAZ;AAQH;AAED,OAAO,eAAeiB,YAAf,CAA4BV,MAA5B,EAAoCP,WAApC,EAAiD;AAEpD,QAAMC,MAAM,GAAGJ,KAAK,CAACK,MAAN,CAAaC,IAAb,CAAkB;AAC7BC,IAAAA,YAAY,EAAGC,IAAD,IAAU;AACpBA,MAAAA,IAAI,CAAC,IAAD,EAAOL,WAAW,CAACA,WAAnB,CAAJ;AACH;AAH4B,GAAlB,CAAf;AAMA,MAAIkB,GAAG,GAAG,MAAMjB,MAAM,CAACQ,GAAP,CAAW,sDAAX,EAClBU,MADkB,CACX,gBADW,EAElBT,GAFkB,EAAhB;AAIH;AAED,OAAO,eAAeU,WAAf,CAA2BpB,WAA3B,EAAwC;AAC3C,MAAIY,GAAG,GAAG,wCAAV;AAEA,SAAOC,KAAK,CAACD,GAAD,EAAM;AACdE,IAAAA,MAAM,EAAE,KADM;AAEdC,IAAAA,OAAO,EAAE;AACLC,MAAAA,aAAa,EAAE,YAAYhB,WAAW,CAACA,WADlC;AAEL,sBAAgB;AAFX;AAFK,GAAN,CAAZ;AAQH","sourcesContent":["var graph = require('@microsoft/microsoft-graph-client');\n\nfunction getAuthenticatedClient(accessToken) {\n    // Initialize Graph client\n    const client = graph.Client.init({\n        // Use the provided access token to authenticate\n        // requests\n        authProvider: (done) => {\n            done(null, accessToken.accessToken);\n        }\n    });\n\n    return client;\n}\n\nexport async function getUserDetails(userId, accessToken) {\n\n    const client = getAuthenticatedClient(accessToken);\n\n    const user = await client.api('/' + userId).get();\n\n    return user;\n}\n\nexport async function getUserPhoto(userId, accessToken) {\n\n    var url = 'https://graph.microsoft.com/v1.0/' + userId + '/photo/$value';\n\n    return fetch(url, {\n        method: 'GET',\n        headers: {\n            Authorization: 'Bearer ' + accessToken.accessToken,\n            'Content-Type': 'application/json',\n        },\n    });\n\n}\n\nexport async function getUserEmail(userId, accessToken) {\n\n    const client = graph.Client.init({\n        authProvider: (done) => {\n            done(null, accessToken.accessToken);\n        }\n    });\n\n    let res = await client.api('/users/25d251d7-f5c3-4f60-b9aa-72f079d32ba1/messages')\n\t.select('sender,subject')\n\t.get();\n\n}\n\nexport async function getAllUsers(accessToken) {\n    var url = 'https://graph.microsoft.com/v1.0/users'\n\n    return fetch(url, {\n        method: 'GET',\n        headers: {\n            Authorization: 'Bearer ' + accessToken.accessToken,\n            'Content-Type': 'application/json',\n        },\n    });\n\n}"]},"metadata":{},"sourceType":"module"}